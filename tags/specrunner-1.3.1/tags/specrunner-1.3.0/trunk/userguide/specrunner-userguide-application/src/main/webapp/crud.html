<!DOCTYPE html>
<html>
<head>
<script src="jquery-1.10.2.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<link href="css/bootstrap.min.css" rel="stylesheet" media="screen"/>
</head>
<body>
    <script>
    var prefix = "/rest/parameter";
    var global;
    
    var id = function(){
    	return $("[id='id']");
    }
    
    var type = function(){
    	return $("[id='type']");
    }
    
    var value = function(){
    	return $("[id='value']");
    }

    var msg = function(str){
    	$("[id='msg']").text(str);
        onSuccess(str);
    }
    
    var read = function() {
        return JSON.stringify({
            Parameter : {
                id : id().val(),
                type : type().val(),
                value : value().val()
            }
        });
    }

    var write = function(vId, vType, vValue) {
        id().val(vId);
		type().val(vType);
		value().val(vValue);
    }
    
    function onSuccess(data){
        $("[id='msg']").removeClass("alert-error");
        $("[id='msg']").addClass("alert-success");
    }
    
    function onError(data) {
		global = data;
		console.log(data);
		msg(data.responseText);
        $("[id='msg']").removeClass("alert-success");
        $("[id='msg']").addClass("alert-error");
    }
    
	function onSelect() {
        if(id().val() && id().val() != "") {
    		$.ajax({
    			type : "GET",
    			url : prefix+"/select/"+id().val(),
                data : {},
    			contentType : 'application/json',
    			dataType : 'json'
    		}).done(function(data) {
    			global = data;
    			write(data.Parameter.id, data.Parameter.type, data.Parameter.value);
    			msg("Selecionado.");
    		}).fail(function(data){
    			onError(data);
    		});
        } else {
            onError({responseText: "Fill in Id field."});
        }
	};

	function onInsert() {
        $.ajax({
			type : "POST",
			url : prefix+"/insert",
            data : read(),
			contentType : 'application/json',
			dataType : 'json'
		}).done(function(data) {
			global = data;
			write(data.Parameter.id, data.Parameter.type, data.Parameter.value);
			msg("Inserido.");
		}).fail(function(data){
			onError(data);
		});
	};
	
	function onUpdate() {
        $.ajax({
            type : "PUT",
            url : prefix+"/update",
            data : read(),
            contentType : 'application/json',
            dataType : 'json'
        }).done(function(data) {
			global = data;
			write(data.Parameter.id, data.Parameter.type, data.Parameter.value);
			msg("Atualizado.");
		}).fail(function(data){
			onError(data);
		});
	}

	function onDelete() {
		$.ajax({
			type : "DELETE",
			url : prefix+"/delete/"+id().val(),
            data : {},
			contentType : 'application/json',
			dataType : 'json'
		}).done(function(data) {
			global = data;
			write(id().val(), "", "");
			msg("Deletado.");
		}).fail(function(data){
			onError(data);
		});
	};
	
</script>

<p/>

    <div class="span6">
        <form class="form-horizontal">
            <div class="control-group">
                <label class="control-label" for="id">Id</label>
                <div class="controls">
                    <input type="text" id="id" placeholder="Parameter id">
                </div>
            </div>

            <div class="control-group">
                <label class="control-label" for="type">Type</label>
                <div class="controls">
                    <select id="type">
                        <option value="BOOLEAN">boolean</option>
                        <option value="LONG">long</option>
                        <option value="DOUBLE">double</option>
                        <option value="STRING">string</option>
                    </select>
                </div>
            </div>

            <div class="control-group">
                <label class="control-label" for="value">Value</label>
                <div class="controls">
                    <textarea type="password" id="value" placeholder="Parameter value"></textarea>
                </div>
            </div>

            <div class="control-group">
                <div class="controls">
                    <a class="btn" type="button" name="select" onclick="onSelect();"><i class="icon-search"></i></a> <a class="btn" type="button" name="insert" onclick="onInsert();"><i
                        class="icon-plus"></i></a> <a class="btn" type="button" name="update" onclick="onUpdate();"><i class="icon-pencil"></i></a> <a class="btn" type="button" name="delete"
                        onclick="onDelete();"><i class="icon-trash"></i></a>
                </div>
            </div>
        </form>
    </div>
    
    <div class="span6">tabela
    </div>
    
    <div class="span12 alert" id="msg"></div>
    
</body>
</html>